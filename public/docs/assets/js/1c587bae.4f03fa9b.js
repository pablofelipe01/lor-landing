"use strict";(globalThis.webpackChunklora_mesh_docs=globalThis.webpackChunklora_mesh_docs||[]).push([[105],{6462:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"claude/message-flow","title":"Message Flow","description":"Detailed explanation of how messages travel through the system.","source":"@site/docs/claude/message-flow.md","sourceDirName":"claude","slug":"/claude/message-flow","permalink":"/docs/claude/message-flow","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Node-RED Configuration","permalink":"/docs/claude/node-red"},"next":{"title":"Claude API Configuration","permalink":"/docs/claude/api-config"}}');var a=s(4848),o=s(8453);const r={sidebar_position:2},i="Message Flow",l={},d=[{value:"Complete Flow Diagram",id:"complete-flow-diagram",level:2},{value:"Response Path",id:"response-path",level:2},{value:"Timing",id:"timing",level:2},{value:"Message Transformation",id:"message-transformation",level:2},{value:"1. Original Message (LoRa)",id:"1-original-message-lora",level:3},{value:"2. MQTT Message (JSON)",id:"2-mqtt-message-json",level:3},{value:"3. Claude API Request",id:"3-claude-api-request",level:3},{value:"4. Claude API Response",id:"4-claude-api-response",level:3},{value:"5. MQTT Response",id:"5-mqtt-response",level:3},{value:"6. LoRa Response",id:"6-lora-response",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"message-flow",children:"Message Flow"})}),"\n",(0,a.jsx)(n.p,{children:"Detailed explanation of how messages travel through the system."}),"\n",(0,a.jsx)(n.h2,{id:"complete-flow-diagram",children:"Complete Flow Diagram"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        USER DEVICE                               \u2502\n\u2502                        (T1000-E)                                 \u2502\n\u2502                                                                  \u2502\n\u2502  User types: "@claude What is photosynthesis?"                  \u2502\n\u2502                           \u2502                                      \u2502\n\u2502                           \u25bc                                      \u2502\n\u2502                    [Send Message]                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502\n                             \u2502 LoRa Radio (915 MHz)\n                             \u2502\n                             \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     LORA MESH NETWORK                            \u2502\n\u2502                                                                  \u2502\n\u2502    May hop through other nodes if direct path unavailable       \u2502\n\u2502                                                                  \u2502\n\u2502    [T1000-E] \u2500\u2500\u25ba [Other Node] \u2500\u2500\u25ba [Gateway]                     \u2502\n\u2502         or                                                       \u2502\n\u2502    [T1000-E] \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba [Gateway]                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502\n                             \u2502 USB Serial\n                             \u2502\n                             \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    RASPBERRY PI 5 GATEWAY                        \u2502\n\u2502                    192.168.68.127                                \u2502\n\u2502                                                                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502  \u2502 Heltec      \u2502        \u2502 Meshtastic      \u2502                     \u2502\n\u2502  \u2502 ESP32 LoRa  \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502 Daemon          \u2502                     \u2502\n\u2502  \u2502 /dev/ttyUSB \u2502        \u2502                 \u2502                     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502\n\u2502                                  \u2502                               \u2502\n\u2502                                  \u2502 Publishes to MQTT            \u2502\n\u2502                                  \u25bc                               \u2502\n\u2502                         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502                         \u2502 Mosquitto       \u2502                     \u2502\n\u2502                         \u2502 Port 1883       \u2502                     \u2502\n\u2502                         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                     \u2502\n                                     \u2502 MQTT (TCP/1883)\n                                     \u2502 Topic: meshtastic/2/json/LongFast/!69d01ebc\n                                     \u2502\n                                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    RECOMPUTER R1025-10                           \u2502\n\u2502                    192.168.68.130                                \u2502\n\u2502                                                                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502                      NODE-RED                            \u2502   \u2502\n\u2502  \u2502                                                          \u2502   \u2502\n\u2502  \u2502  [MQTT In] \u2500\u2500\u25ba [Detect @claude] \u2500\u2500\u25ba [Prepare Request]   \u2502   \u2502\n\u2502  \u2502                                            \u2502             \u2502   \u2502\n\u2502  \u2502                                            \u25bc             \u2502   \u2502\n\u2502  \u2502                                    [HTTP Request]        \u2502   \u2502\n\u2502  \u2502                                    api.anthropic.com     \u2502   \u2502\n\u2502  \u2502                                            \u2502             \u2502   \u2502\n\u2502  \u2502                                            \u25bc             \u2502   \u2502\n\u2502  \u2502  [MQTT Out] \u25c4\u2500\u2500 [Format Response] \u25c4\u2500\u2500 [Process]         \u2502   \u2502\n\u2502  \u2502                                                          \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502\n                             \u2502 HTTPS (443)\n                             \u2502\n                             \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                       CLAUDE API                                 \u2502\n\u2502                    api.anthropic.com                             \u2502\n\u2502                                                                  \u2502\n\u2502  Receives: "What is photosynthesis?"                            \u2502\n\u2502  Returns: "Photosynthesis is the process by which plants..."    \u2502\n\u2502                                                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n'})}),"\n",(0,a.jsx)(n.h2,{id:"response-path",children:"Response Path"}),"\n",(0,a.jsx)(n.p,{children:"The response follows the reverse path:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Claude API\n    \u2502\n    \u25bc\nNode-RED (Process & Format)\n    \u2502\n    \u25bc\nMQTT Publish (sendtext topic)\n    \u2502\n    \u25bc\nMosquitto Broker\n    \u2502\n    \u25bc\nMeshtastic Daemon\n    \u2502\n    \u25bc\nLoRa Radio\n    \u2502\n    \u25bc\nT1000-E (User receives response)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"timing",children:"Timing"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Step"}),(0,a.jsx)(n.th,{children:"Typical Time"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"User to Gateway (LoRa)"}),(0,a.jsx)(n.td,{children:"1-5 seconds"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"MQTT Processing"}),(0,a.jsx)(n.td,{children:"Less than 100ms"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Claude API"}),(0,a.jsx)(n.td,{children:"2-10 seconds"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Response to User"}),(0,a.jsx)(n.td,{children:"1-5 seconds"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Total"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"5-30 seconds"})})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"message-transformation",children:"Message Transformation"}),"\n",(0,a.jsx)(n.h3,{id:"1-original-message-lora",children:"1. Original Message (LoRa)"}),"\n",(0,a.jsx)(n.p,{children:"Binary LoRa packet with text payload."}),"\n",(0,a.jsx)(n.h3,{id:"2-mqtt-message-json",children:"2. MQTT Message (JSON)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "channel": 0,\n  "from": 2846474973,\n  "payload": {\n    "text": "@claude What is photosynthesis?"\n  },\n  "sender": "!a9b8c7d6",\n  "type": "text"\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"3-claude-api-request",children:"3. Claude API Request"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "model": "claude-sonnet-4-20250514",\n  "max_tokens": 150,\n  "messages": [\n    {\n      "role": "user",\n      "content": "What is photosynthesis?"\n    }\n  ]\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"4-claude-api-response",children:"4. Claude API Response"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "content": [\n    {\n      "type": "text",\n      "text": "Photosynthesis is the process by which plants convert sunlight, water, and CO2 into glucose and oxygen."\n    }\n  ]\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"5-mqtt-response",children:"5. MQTT Response"}),"\n",(0,a.jsx)(n.p,{children:"Simple text string sent to sendtext topic."}),"\n",(0,a.jsx)(n.h3,{id:"6-lora-response",children:"6. LoRa Response"}),"\n",(0,a.jsx)(n.p,{children:"Binary packet with truncated text (max ~200 chars)."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>i});var t=s(6540);const a={},o=t.createContext(a);function r(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);
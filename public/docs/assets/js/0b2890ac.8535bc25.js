"use strict";(globalThis.webpackChunklora_mesh_docs=globalThis.webpackChunklora_mesh_docs||[]).push([[28],{685:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"configuration/mqtt","title":"MQTT Configuration","description":"MQTT broker setup and message routing.","source":"@site/docs/configuration/mqtt.md","sourceDirName":"configuration","slug":"/configuration/mqtt","permalink":"/docs/configuration/mqtt","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Meshtastic Configuration","permalink":"/docs/configuration/meshtastic"},"next":{"title":"Internal Network","permalink":"/docs/configuration/internal-network"}}');var i=s(4848),o=s(8453);const r={sidebar_position:2},l="MQTT Configuration",c={},a=[{value:"Overview",id:"overview",level:2},{value:"Mosquitto Broker",id:"mosquitto-broker",level:2},{value:"Installation (already done on RPi5)",id:"installation-already-done-on-rpi5",level:3},{value:"Configuration File",id:"configuration-file",level:3},{value:"Verify service",id:"verify-service",level:3},{value:"Test connection",id:"test-connection",level:3},{value:"Topic Structure",id:"topic-structure",level:2},{value:"Meshtastic topics",id:"meshtastic-topics",level:3},{value:"Subscribe to all Meshtastic traffic",id:"subscribe-to-all-meshtastic-traffic",level:3},{value:"Message Format",id:"message-format",level:2},{value:"Received message (JSON)",id:"received-message-json",level:3},{value:"Send message",id:"send-message",level:3},{value:"Node-RED Integration",id:"node-red-integration",level:2},{value:"MQTT In Node",id:"mqtt-in-node",level:3},{value:"MQTT Out Node",id:"mqtt-out-node",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Connection refused",id:"connection-refused",level:3},{value:"No messages",id:"no-messages",level:3},{value:"Messages not reaching mesh",id:"messages-not-reaching-mesh",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"mqtt-configuration",children:"MQTT Configuration"})}),"\n",(0,i.jsx)(n.p,{children:"MQTT broker setup and message routing."}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"MQTT (Message Queuing Telemetry Transport) is used to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Bridge LoRa messages to IP network"}),"\n",(0,i.jsx)(n.li,{children:"Enable Node-RED to process messages"}),"\n",(0,i.jsx)(n.li,{children:"Route Claude responses back to mesh"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"mosquitto-broker",children:"Mosquitto Broker"}),"\n",(0,i.jsx)(n.h3,{id:"installation-already-done-on-rpi5",children:"Installation (already done on RPi5)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt install mosquitto mosquitto-clients\nsudo systemctl enable mosquitto\nsudo systemctl start mosquitto\n"})}),"\n",(0,i.jsx)(n.h3,{id:"configuration-file",children:"Configuration File"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"/etc/mosquitto/mosquitto.conf"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"listener 1883\nallow_anonymous true\n"})}),"\n",(0,i.jsx)(n.h3,{id:"verify-service",children:"Verify service"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo systemctl status mosquitto\n"})}),"\n",(0,i.jsx)(n.h3,{id:"test-connection",children:"Test connection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Terminal 1: Subscribe\nmosquitto_sub -h 192.168.68.127 -t "test/#" -v\n\n# Terminal 2: Publish\nmosquitto_pub -h 192.168.68.127 -t "test/hello" -m "Hello World"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"topic-structure",children:"Topic Structure"}),"\n",(0,i.jsx)(n.h3,{id:"meshtastic-topics",children:"Meshtastic topics"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Topic"}),(0,i.jsx)(n.th,{children:"Direction"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"meshtastic/2/json/LongFast/!69d01ebc"})}),(0,i.jsx)(n.td,{children:"Receive"}),(0,i.jsx)(n.td,{children:"Messages from mesh"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"meshtastic/2/json/LongFast/!69d01ebc/sendtext"})}),(0,i.jsx)(n.td,{children:"Send"}),(0,i.jsx)(n.td,{children:"Messages to mesh"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"subscribe-to-all-meshtastic-traffic",children:"Subscribe to all Meshtastic traffic"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'mosquitto_sub -h 192.168.68.127 -t "meshtastic/#" -v\n'})}),"\n",(0,i.jsx)(n.h2,{id:"message-format",children:"Message Format"}),"\n",(0,i.jsx)(n.h3,{id:"received-message-json",children:"Received message (JSON)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "channel": 0,\n  "from": 2846474973,\n  "id": 123456789,\n  "payload": {\n    "text": "@claude What is LoRa?"\n  },\n  "sender": "!a9b8c7d6",\n  "timestamp": 1699900000,\n  "to": 4294967295,\n  "type": "text"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"send-message",children:"Send message"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'mosquitto_pub -h 192.168.68.127 \\\n  -t "meshtastic/2/json/LongFast/!69d01ebc/sendtext" \\\n  -m "Hello from MQTT"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"node-red-integration",children:"Node-RED Integration"}),"\n",(0,i.jsx)(n.h3,{id:"mqtt-in-node",children:"MQTT In Node"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Server: 192.168.68.127:1883"}),"\n",(0,i.jsxs)(n.li,{children:["Topic: ",(0,i.jsx)(n.code,{children:"meshtastic/2/json/LongFast/!69d01ebc"})]}),"\n",(0,i.jsx)(n.li,{children:"QoS: 0"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"mqtt-out-node",children:"MQTT Out Node"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Server: 192.168.68.127:1883"}),"\n",(0,i.jsxs)(n.li,{children:["Topic: ",(0,i.jsx)(n.code,{children:"meshtastic/2/json/LongFast/!69d01ebc/sendtext"})]}),"\n",(0,i.jsx)(n.li,{children:"QoS: 0"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"connection-refused",children:"Connection refused"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check if Mosquitto is running\nsudo systemctl status mosquitto\n\n# Check port\nnetstat -tlnp | grep 1883\n\n# Check firewall\nsudo ufw status\n"})}),"\n",(0,i.jsx)(n.h3,{id:"no-messages",children:"No messages"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Subscribe to everything\nmosquitto_sub -h 192.168.68.127 -t "#" -v\n\n# Check Meshtastic MQTT settings\nmeshtastic --get mqtt\n'})}),"\n",(0,i.jsx)(n.h3,{id:"messages-not-reaching-mesh",children:"Messages not reaching mesh"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Verify topic is correct"}),"\n",(0,i.jsx)(n.li,{children:"Check Meshtastic service is running"}),"\n",(0,i.jsx)(n.li,{children:"Verify MQTT settings in Meshtastic"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>l});var t=s(6540);const i={},o=t.createContext(i);function r(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);
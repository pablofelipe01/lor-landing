"use strict";(globalThis.webpackChunklora_mesh_docs=globalThis.webpackChunklora_mesh_docs||[]).push([[175],{6577:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"claude/api-config","title":"Claude API Configuration","description":"Setup and configuration of the Claude API integration.","source":"@site/docs/claude/api-config.md","sourceDirName":"claude","slug":"/claude/api-config","permalink":"/docs/claude/api-config","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Message Flow","permalink":"/docs/claude/message-flow"},"next":{"title":"Send a Message","permalink":"/docs/guides/send-message"}}');var r=s(4848),t=s(8453);const l={sidebar_position:3},o="Claude API Configuration",a={},d=[{value:"API Overview",id:"api-overview",level:2},{value:"Authentication",id:"authentication",level:2},{value:"API Key",id:"api-key",level:3},{value:"Headers Required",id:"headers-required",level:3},{value:"Request Format",id:"request-format",level:2},{value:"Basic Request",id:"basic-request",level:3},{value:"With System Prompt",id:"with-system-prompt",level:3},{value:"Response Format",id:"response-format",level:2},{value:"Successful Response",id:"successful-response",level:3},{value:"Configuration Parameters",id:"configuration-parameters",level:2},{value:"Model Selection",id:"model-selection",level:3},{value:"Token Limits",id:"token-limits",level:3},{value:"System Prompt",id:"system-prompt",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Common Errors",id:"common-errors",level:3},{value:"401 Unauthorized",id:"401-unauthorized",level:4},{value:"429 Rate Limited",id:"429-rate-limited",level:4},{value:"500 Server Error",id:"500-server-error",level:4},{value:"Rate Limiting",id:"rate-limiting",level:2},{value:"Testing the API",id:"testing-the-api",level:2},{value:"Using curl",id:"using-curl",level:3},{value:"Using Node-RED",id:"using-node-red",level:3},{value:"Costs",id:"costs",level:2},{value:"Security Notes",id:"security-notes",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"claude-api-configuration",children:"Claude API Configuration"})}),"\n",(0,r.jsx)(n.p,{children:"Setup and configuration of the Claude API integration."}),"\n",(0,r.jsx)(n.h2,{id:"api-overview",children:"API Overview"}),"\n",(0,r.jsx)(n.p,{children:"We use the Claude Messages API to process user questions."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint"}),": ",(0,r.jsx)(n.code,{children:"https://api.anthropic.com/v1/messages"})]}),"\n",(0,r.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,r.jsx)(n.h3,{id:"api-key",children:"API Key"}),"\n",(0,r.jsx)(n.p,{children:"The API key is stored as an environment variable in Node-RED."}),"\n",(0,r.jsxs)(n.p,{children:["Format: ",(0,r.jsx)(n.code,{children:"sk-ant-api03-xxxxx..."})]}),"\n",(0,r.jsx)(n.h3,{id:"headers-required",children:"Headers Required"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"x-api-key: <your-api-key>\nanthropic-version: 2023-06-01\ncontent-type: application/json\n"})}),"\n",(0,r.jsx)(n.h2,{id:"request-format",children:"Request Format"}),"\n",(0,r.jsx)(n.h3,{id:"basic-request",children:"Basic Request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "model": "claude-sonnet-4-20250514",\n  "max_tokens": 150,\n  "messages": [\n    {\n      "role": "user",\n      "content": "Your question here"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"with-system-prompt",children:"With System Prompt"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "model": "claude-sonnet-4-20250514",\n  "max_tokens": 150,\n  "system": "You are a helpful assistant for a rural community. Give brief, clear answers. Maximum 2-3 sentences.",\n  "messages": [\n    {\n      "role": "user",\n      "content": "What is LoRa?"\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"response-format",children:"Response Format"}),"\n",(0,r.jsx)(n.h3,{id:"successful-response",children:"Successful Response"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "id": "msg_01XFDUDYJgAACzvnptvVoYEL",\n  "type": "message",\n  "role": "assistant",\n  "content": [\n    {\n      "type": "text",\n      "text": "LoRa (Long Range) is a wireless technology that enables long-distance communication with low power consumption, ideal for IoT devices."\n    }\n  ],\n  "model": "claude-sonnet-4-20250514",\n  "stop_reason": "end_turn",\n  "usage": {\n    "input_tokens": 10,\n    "output_tokens": 35\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"configuration-parameters",children:"Configuration Parameters"}),"\n",(0,r.jsx)(n.h3,{id:"model-selection",children:"Model Selection"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Model"}),(0,r.jsx)(n.th,{children:"Speed"}),(0,r.jsx)(n.th,{children:"Quality"}),(0,r.jsx)(n.th,{children:"Cost"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"claude-sonnet-4-20250514"}),(0,r.jsx)(n.td,{children:"Fast"}),(0,r.jsx)(n.td,{children:"Good"}),(0,r.jsx)(n.td,{children:"Low"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"claude-opus-4-20250514"}),(0,r.jsx)(n.td,{children:"Slow"}),(0,r.jsx)(n.td,{children:"Best"}),(0,r.jsx)(n.td,{children:"High"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["We use ",(0,r.jsx)(n.code,{children:"claude-sonnet-4-20250514"})," for speed and cost efficiency."]}),"\n",(0,r.jsx)(n.h3,{id:"token-limits",children:"Token Limits"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"max_tokens"}),": 150 (keeps responses short for LoRa)"]}),"\n",(0,r.jsx)(n.li,{children:"LoRa message limit: ~230 bytes"}),"\n",(0,r.jsx)(n.li,{children:"We truncate responses over 200 characters"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"system-prompt",children:"System Prompt"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"You are a helpful assistant for a rural community.\nGive brief, clear answers. Maximum 2-3 sentences.\nRespond in the same language as the question.\n"})}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.h3,{id:"common-errors",children:"Common Errors"}),"\n",(0,r.jsx)(n.h4,{id:"401-unauthorized",children:"401 Unauthorized"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "error": {\n    "type": "authentication_error",\n    "message": "invalid x-api-key"\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Verify API key is correct."]}),"\n",(0,r.jsx)(n.h4,{id:"429-rate-limited",children:"429 Rate Limited"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "error": {\n    "type": "rate_limit_error",\n    "message": "Rate limit exceeded"\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Wait and implement rate limiting."]}),"\n",(0,r.jsx)(n.h4,{id:"500-server-error",children:"500 Server Error"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "error": {\n    "type": "api_error",\n    "message": "Internal server error"\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Retry after a few seconds."]}),"\n",(0,r.jsx)(n.h2,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,r.jsx)(n.p,{children:"To avoid hitting rate limits, implement delays between requests:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// In Node-RED function node\nvar lastCall = flow.get("lastClaudeCall") || 0;\nvar now = Date.now();\n\nif (now - lastCall < 5000) { // 5 second minimum\n    return null; // Skip this request\n}\n\nflow.set("lastClaudeCall", now);\nreturn msg;\n'})}),"\n",(0,r.jsx)(n.h2,{id:"testing-the-api",children:"Testing the API"}),"\n",(0,r.jsx)(n.h3,{id:"using-curl",children:"Using curl"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://api.anthropic.com/v1/messages \\\n  -H "x-api-key: YOUR_API_KEY" \\\n  -H "anthropic-version: 2023-06-01" \\\n  -H "content-type: application/json" \\\n  -d \'{\n    "model": "claude-sonnet-4-20250514",\n    "max_tokens": 100,\n    "messages": [\n      {"role": "user", "content": "Say hello"}\n    ]\n  }\'\n'})}),"\n",(0,r.jsx)(n.h3,{id:"using-node-red",children:"Using Node-RED"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Add Inject node"}),"\n",(0,r.jsx)(n.li,{children:"Add Function node with test payload"}),"\n",(0,r.jsx)(n.li,{children:"Add HTTP Request node"}),"\n",(0,r.jsx)(n.li,{children:"Add Debug node"}),"\n",(0,r.jsx)(n.li,{children:"Deploy and click inject"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"costs",children:"Costs"}),"\n",(0,r.jsx)(n.p,{children:"API calls are billed based on tokens:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Input tokens: Question length"}),"\n",(0,r.jsx)(n.li,{children:"Output tokens: Response length"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"With our configuration (~150 tokens max), costs are minimal per query."}),"\n",(0,r.jsx)(n.h2,{id:"security-notes",children:"Security Notes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Never expose API key in client-side code"}),"\n",(0,r.jsx)(n.li,{children:"Store key in environment variables"}),"\n",(0,r.jsx)(n.li,{children:"Rotate keys periodically"}),"\n",(0,r.jsx)(n.li,{children:"Monitor usage for anomalies"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);